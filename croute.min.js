/*!
 * conkitty-route v0.12.0, https://github.com/hoho/conkitty-route
 * (c) 2014-2015 Marat Abdullin, MIT license
 */
window.$CR=function(e,n,t,r,i,o,a){"use strict";function f(e,n,r,i){for(n=[],r=0;r<e.length;r++)i=e[r],n.push(t(i.name)+"="+t(i.value));return n.join("&")}function c(e,n,t,r,i,o,f,s,l){if(!r&&n&&n(e),f=e.children.slice(0),i){s=e.namedChildren;for(o in s)f.push(s[o])}for(o=0;o<f.length&&!(l=c(s=f[o],n,t,a,i));o++);return!r&&t&&t(e)}function s(e,n,t){if(n){var r,i,o,a,f,c,s=n.parent,l=n._id;e&&!s.active()&&_("Parent is not active"),r=l in Z,i=n._p,a={},o=Object.keys(i);for(c=o.length;c--;)f=o[c],a[f]=i[f];if(f=!$H.eq(a,t||{}),!e&&r||f)for(delete Z[l],(c=W[l])&&c.remove(),!e&&r&&E(n),c=o.length;c--;)delete i[o[c]];if(e&&(!r||f)){if(Z[l]=n,t)for(f in t)i[f]=t[f];f=W[s._id],f=new M(n,f,W,!0),f.load()}}}function l(e,n,t,r,i){var o=n.state,f=t[0],c=o?o.call(e,f,r,i):a,s=t[2];t[2]=r,c===a&&(r===he&&s===pe&&(f.disabled=!1),r===pe&&(f.disabled?t[2]=s:f.disabled=!0))}function u(e,n,t){var r,i=n._fi;for(r=0;r<i.length;r++)l(e,n,i[r],t)}function h(e,n){new x(re,a,e,n)}function d(e){return"function"==typeof e}function p(e){return e instanceof Array}function m(e){return"string"==typeof e}function g(e){return e instanceof Node}function v(e){!!J!=!!e&&_("Running: "+!!J)}function _(e){throw new Error(e)}function b(e,n,t,r,i,o){if(r=ae[e]){if(n=n.isForm?n.parent:n,t=[e].concat(t||[]),(o=n._id)&&(i=r[o]))for(o=0;o<i.length;o++)i[o].apply(n,t);if(i=r[""])for(o=0;o<i.length;o++)i[o].apply(n,t)}}function y(e,n,t,r,i){return i="?"===e.charAt(1)?2:1,e=e.substring(i),e in n&&!t&&_("Duplicate param"),n[e]=i,e={param:e,optional:2===i},r&&r.push(e),r?"(?:/([^/]+))"+(2===i?"?":""):e}function w(e,t,r){var i,o,f,c,s,l,u,h={},d=[],p=[];for((e||"").replace(/^((?:(?:\:\?)|[^?#])*)(?:\?([^#]*))?(?:#(.*))?$/,function(e,n,t,r){i=(n||"").split("/"),o=(t||"").split("&"),f=r}),l=i.length,c=0;l>c;c++)((s=n(i[c]))||r&&c===l-1)&&d.push(":"===s.charAt(0)?y(s,h,t,t?a:p):t?s:"/"+s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));for(c=0;c<o.length;c++)(s=o[c])&&(u||(u={}),~(l=s.indexOf("="))?(l=s.substring(l+1),s=n(s.substring(0,s.length-l.length-1)),l=n(l)):l=ke,":"===s.charAt(0)&&_("Invalid queryparam"),s in u&&_("Duplicate queryparam"),u[s]=l&&":"===l.charAt(0)?y(l,h,t):{value:l});return f&&(f=":"===f.charAt(0)?y(f,h,t):{value:f}),{pathname:[d,p],search:u,hash:f,params:h}}function k(e,n,t,r,i,o,f,c,s,l){switch(r.param&&i&&(s=i[r.param]),!0){case"value"in r?r.value===t:t!==a&&!s:l=!0;break;case d(s):l=(t=s.call(e,f,t))!==a||r.optional;break;case t===a&&r.optional:l=!0;break;case s instanceof RegExp&&t!==a:l=s.test(t);break;case p(s):l=s.indexOf(t)>=0;break;case m(s):l=s===t;break;default:l=!1}return l&&t!==a&&(n!==a&&(o[n]=t),r&&(n=r.param)&&(f[n]=c[n]=t)),l}function C(e,n,t,r){if(n||t||c(e,a,function(e){e._a&&C(e,n,!0)},!0),!!(r=e._a)==!n)for(;e;)e._a+=n||-r,e=e.parent}function x(e,n,t,r,i,o,f,c,s){function l(e,n,t,i){for(t=Object.keys(M),i=t.length;i--;)n=t[i],H.hasOwnProperty(n)||delete M[n];for(n in O)n in q||(t=O[n],(t=d(t)?t.call(E,M):t)!==a&&(M[n]=t));return(e=r.matcher)?e.call(E,M):!0}var u,h,m,g,v,b,y,F,A,O,H,R,q,E=this,T=/.*/,M=E._p=Fe({},f&&f._p);if(E.parent=f,E.root=f?f.root||f:E,E.children=[],E.namedChildren={},E.uri=t,E._id="r"+ ++ie,E._n={},E._d=[],r){if(E.title=r.title||f&&f.title,E[we]=r.parent||f&&f[we],E.render=N(r.render),c)E.isForm=!0,(g=E.action=r.action)&&$(g),E._method=r.method,E.check=r.check,E.state=r.state,E.type=r.type,E[ye]=r[ye],E.xhr=r.xhr;else{if(s?(E.isNamed=!0,e[t]=E,t=a):(e.push(E),n&&(E._g=n,n.push(E)),O=r.params,(u=E.id=r.id)&&(u in oe&&_("Duplicate id: "+u),oe[u]=E),E["break"]=r["break"],E["final"]=r["final"],E.partial=r.partial,E.reduce=r.reduce,E.wait=((u=r.wait)===a?f&&f.wait:u)||!1),E.keep=r.keep,E[ue]=j(r.data),E.form=r.form,v=r.on)for(g in ae)if(m=v[g])for(p(m)||(m=[m]),u=0;u<m.length;u++)Ae.on(g,m[u],E);(g=r.refresh)&&(E._refresh=$e(5,g)?g:Ae.$.refresh(g))}if(((g=r.tags)||(u=E.id))&&(E.tags=m={},u&&(m[u]=!0),g))for(g=g.split(se),u=g.length;u--;)m[g[u]]=!0}if(t!==a){if(t=w(t),R=(i||[]).concat(t.pathname[0]),b=new RegExp("^"+R.join("")+"(?:/(.*))?$"),y=t.pathname[1],F=t.search,A=t.hash,o||(o=1),T=function(e){q={},H={};var n,t=e.match(b);if(t){for(n=0;n<y.length;n++){if(!k(E,a,t[o+n],g=y[n],O,a,H,M)){n=!1;break}g&&(g=g.param)&&(q[g]=!0)}if(n===!1||!F&&!A&&!l())return C(E),!1;((n=!t[o+y.length])||E.partial)&&E["final"]!==!1&&(n?C(E,1):(n=!0,V[E._id]=E))}return E._a||n?H:!1},(F||A)&&(T={pathname:T},F&&(T.search=function(){var e,n={};for(e in F){if(!k(E,e,B[e],g=F[e],O,n,H,M)){n=!1;break}g&&(g=g.param)&&(q[g]=!0)}return(n===!1||!A&&!l())&&(C(E),n=!1),n}),A&&(T.hash=function(e){var n=k(E,a,e||a,A,O,a,H,M)&&l()?e||!0:!1;return n||C(E),(g=A.param)&&(q[g]=!0),n})),h=r&&r.frames)for(m in h)for(p(g=h[m])?n=[]:(g=[g],n=a),u=0;u<g.length;u++)new x(E.children,n,m,g[u],E.reduce===!1?i:R,o+(E.reduce===!1?0:y.length),E);if(h=r&&r.named)for(m in h)new x(E.namedChildren,a,m,h[m],a,a,E,a,!0)}c||s||$H.on(T,{go:function(e){t||(E._a=1),E._s=e}}),s||(E.activate=E.deactivate=a)}function j(e,n,t,r){for(r=p(e),n=[r,t=e===a?[]:r?e:[e]],r=0;r<t.length;r++)$(t[r]);return n}function $(e){e&&($e(2,e)||$e(4,e)||m(e)||d(e))||_("Unexpected `"+e+"` as data source")}function N(e){function n(e){return m(e)||d(e)||$e(1,e)||$e(3,e)||e===ke}e=n(e)||p(e)?{success:e}:e||{};var t,r,i,o,f,c,s,l={},u=[me,ge,ve,_e,be],h={"-":!1,"":a,"+":!0};for(t=u.length;t--;){r="",c=a;for(r in h)if(p(f=e[r+(o=u[t])])||f===a||(f=[f]),f){for(c||(c=[]),i=0;i<f.length;i++)n(s=f[i])||_("Unexpected `"+s+"` as a template"),c.push({s:h[r],v:s});l[o]=c}}return l}function F(e,n,t,r){return r=n.param,(t&&r in t?t:e._p)[r]}function A(n,t){return t=e.createElement("a"),t.href=n,t.href=t.href,t}function O(e,n,i,o,f,c,s,l,u){var h,d,m,g,v;if(c||(o=[],f=[],c={}),i!==a&&"object"!=typeof i&&_("Invalid params `"+i+"`"),l||(h=A(n),(u=h.protocol!==r.protocol||h.host!==r.host?h.protocol+"//"+h.host:"")&&(n=h.pathname+h.search,(d=h.hash)&&d.length>1&&(n+=d))),!e||e&&e.reduce!==!1){for(n=w(n,!0,!i),m=n.pathname[0],h=m.length;h--;)g=m[h],v=g.param?F(e,g,i):g,v!==a&&o.unshift(t(v));if(m=n.search)for(h in m)if(!(h in c)){if(c[h]=!0,g=m[h],h=t(h),g.param){if(v=F(e,g,i),p(v)){for(d=0;d<v.length;d++)f.push(h+"="+t(v[d]));continue}}else v=g.value;v!==a&&f.push(h+"="+t(v))}!s&&(m=n.hash)&&(s=m.param?F(e,m,i):m.value)}return i&&e&&(h=e.parent)&&O(h,h.uri,i,o,f,c,s,!0,u),l?void 0:(o=u+("/"+o.join("/")).replace(/\/+/g,"/"),f.length&&(o+="?"+f.join("&")),s&&(o+="#"+t(s)),o)}function H(e,n,t,r,i,o,f,c,s,l,u){if(i=this,u=n.method,n=n.isForm?n.parent:n,$e(4,e)&&(e=e.v)){if((f=e.override)&&(f=f.call(n,n._p))!==a)return{o:f};u=e.method||u,o=e.parse,c=e.transform,e=e.uri,d(e)&&(e=e.call(n,n._p),l=!0)}d(u)&&(u=u.call(n,n._p)),i.ok=[],i.err=[],i.r=r=new XMLHttpRequest,r.open(r.method=(u||"GET").toUpperCase(),r.uri=l?e:O(n,e),!0),b("xhr",n,[r,!1]),r.onreadystatechange=function(){if(4===r.readyState){if(b("xhr",n,[r,!0]),i.d=i.e=!0,2===(r.status/100|0))try{s=r.responseText,s=o?o.call(n,s,r):204===r.status?a:JSON.parse(s),i.j=c?c.call(n,s,r):s,i.e=!1}catch(e){}i.done(),i.r=a}},t&&(t=t(r)),t!==a?r.send(t):r.send()}function R(n,t,r,i,o,f){return i=t,n=n.isForm?n.parent:n,m(r)&&(r=a),t=t||r||P,t&&!g(t)&&(t=d(t)?t.call(n):e.querySelector(t)),g(t)?((o=t._$Cid)||(t._$Cid=o=++ie),f=n._n,f[o]||(f[o]=[r=e.createComment("")],t.appendChild(r))):t="No node `"+i+"`"+((i=n.id)?" ("+i+")":""),t}function q(n,t,r,i,o,f,c){var s,l,u,h,v,b,y,w,k,C,x,j=R(r,r[we]),$=r.render,N="nextSibling";if(c=c===a?$[n]||K[n]||[]:c.s===a||c.s===r.active(!0)?c.v:a,p(c)){if(n===be&&!c.length)throw t[0];try{if(f={},!c.length&&(n===ge||n===ve)){x=r._n;for(s in x)if(x[s].length>1){c=[{v:ke}];break}}for(s=0;s<c.length&&q(n,t,r,i,o,f,c[s])!==!1;s++);}catch(F){if(n===be)throw F;k=[F,n,s,c[s]]}}else if(c||c===ke){if(r.isForm&&(r=r.parent),w=[o||n===be?t:t[0],r._p],i&&w.push(i),d(c)&&(c=c.apply(r,w),c===!1||c===a))return c;if($e(1,c))d(s=c.u)?s=s.apply(r,w):(d(C=c.p)&&(C=C.apply(r,w)),s=O(a,s,Fe(C,r._p))),Ae.set(s,c.r,c.e);else if(c){if(g(c)&&(u=c),s=m(c)?c:c.n,d(s)&&(u=s=s.apply(r,w)),m(s)&&(w.unshift(s),u=z.apply(r,w),m(u)))for(s=e.createElement("div"),s.innerHTML=u,u=e.createDocumentFragment(),s=s.firstChild;s;)C=s[N],u.appendChild(s),s=C;if(u===!1)return u}if(!c||g(u)){if(E(),v=R(r,c&&c.p,j),m(v)&&_(v),x=r._n,l=x[b=v._$Cid],y=l[0],!(b in f||c&&c.r===!1))for(s in x)s=x[s],f._&&s!==l||(r._d=r._d.concat(s.splice(1,s.length-1)),E());if(f[b]=f._=!0,c&&(h=y.parentNode))for(C=y.previousSibling,h.insertBefore(u,y),s=C?C[N]:h.firstChild;s!==y;s=s[N])l.push(s),s[le]=r}}return k}function E(e,n){if(e)c(e,function(e,n,t,r){for(n=e._d;r=n.pop();)(t=r.parentNode)&&t.removeChild(r)},a,a,!0);else for(n=re.length;n--;)E(re[n])}function T(e,n,t,r){this.handlers=e,this.wait=n,t&&this.mount(t,r)}function M(e,n,t,r){var i=this;i.parent=n,i.frame=e,i.children={},i.root=t,i.count=0,i.waiting=0,i.counters(1),t[e._id]=i,n&&(n.children[e._id]=i),r||i.reconcile()}function S(e,n,t,r,i){if(e)for(n(e),t=e.children,r=Object.keys(t),i=0;i<r.length;i++)S(t[r[i]],n)}function U(e,n,t,r){var o,f,c,s=[],l=e._id,u=[];t===a&&(t=n.r),d(t)&&(t=t.call(e)),t=+t,!(l in W)||W[l].count||l in ne||(D(e._id),ee[l]=s,s[0]=i(function(){ee[l]===s&&(s[0]=a,c=n.o,d(c)&&(c=c.call(e)),c=+c,!isNaN(c)&&c>0&&(s[1]=i(function(t){s[1]=a,ee[l]===s&&(t=n.a,t===a&&(t=n.r),t!==a&&U(e,n,t,r))},c)),s[2]=new T({success:function(e,n){if(!o&&ee[l]===s){var t,r,i=e.loaded,a=n._data,c=!0;if(a||f){if(f)c=!1;else for(t=i.length;c&&t--;)r=n[ue][1][t],c=c&&($e(4,r)&&r.v.eq||$H.eq).call(n,i[t],a[t]);c||(f=!0,u.push([e,n]))}}},ready:function(n,t,r,i,f,c){if(t._id===l&&ee[l]===s&&!o){for(;r=u.shift();)if(i=r[0],f=r[1],c=q(ge,f._data=i.loaded,f,a,i.isArray))return b(be,f,c),q(be,c,f),void i.remove();(f=e._refresh)&&f.r&&U(e,f)}},error:function(){o||(o=!0,U(e,n,t,r))}},!0,e,r))},isNaN(t)||0>t?0:t))}function D(e,n){(n=ee[e])&&(n[0]&&o(n[0]),n[1]&&o(n[1]),n[2]&&n[2].unmount(),delete ee[e])}function I(e,n){var t,r,i,o,f,c,s,l=[],u=[];if(e instanceof HTMLFormElement)for(i=e.elements,t=0;t<i.length;t++){if(o=i[t],s=a,f=o.name)switch(o.type){case ye:case"reset":case"button":case"file":break;case"checkbox":case"radio":o.checked&&(s=o.value||"");break;case"select-multiple":for(c=o.options,s=[],r=0;r<c.length;r++)c[r].selected&&s.push(c[r].value);break;default:s=o.value||""}if(u.push([o,s]),!o.disabled&&s!==a)for(p(s)||(s=[s]),r=0;r<s.length;r++)l.push({name:f,value:s[r]})}return n?[l,u]:l}var L,K,P,z,J,B,G,W,X,Q,V,Y,Z={},ee={},ne={},te={},re=[],ie=0,oe={},ae={before:{},success:{},error:{},after:{},stop:{},except:{},leave:{},busy:{},idle:{},xhr:{}},fe=!1,ce=0,se=/[\x20\t\r\n\f]+/,le="_$Cf",ue="dataSource",he="valid",de="invalid",pe="sending",me="before",ge="success",ve="error",_e="after",be="except",ye="submit",we="renderParent",ke=null,Ce="matches",xe=x.prototype,je=function(e){this._=e},$e=function(e,n){return n instanceof je&&n._===e},Ne=function(){},Fe=function(e,n){var t=function(n){for(n in e)this[n]=e[n]};return t.prototype=n||new Ne,new t},Ae=function(e,n){return v(),m(e)&&m(n)?h(e,{render:function(e,t){Ae.set(O(a,n,t),a,!0)}}):e?h(e,n):Q||(Q=n),Ae};return Ae.add=Ae,Ae.set=function(e,n,t){return v(!0),X=n,e=A(e),t||(t=r.href===e.href),$H.go(e.href,a,t)},Ae.run=function(n){v();for(var t=e.body,s=t.addEventListener.bind(t),l=["oM","msM","mozM","webkitM","m"];Ce&&!t[Ce];)Ce=l.pop()+"atchesSelector";n=n||{},L=n.title,K=N(n.render),P=n.parent||t,z=n.callTemplate||function(e,n,t,r,i,o){return(i=$C.tpl[e])||_("No `"+e+"` template"),o=[n,t,this],r&&o.push(r),i.apply(ke,o)},Q&&h(a,Q),W=new T({before:function(n,t,r,i){r=(r=d(r=t.title)?r.call(t,t._p):r)===a?L:r,r!==a&&(e.title=r),b(me,t),(i=q(me,[],t,n.form))&&(b(be,t,i),q(be,i,t,n.form),n.remove())},stop:function(e,n){b("stop",n)},success:function(e,n,t){(t=q(ge,e.loaded,n,e.form,e.isArray))?(b(be,n,t),q(be,t,n,e.form),e.remove()):(b(ge,n,e.loaded),(t=q(_e,[],n,e.form))?(b(be,n,t),q(be,t,n,e.form),e.remove()):b(_e,n)),n.isForm&&u(n.parent,n,he),n.isForm&&n.tags&&Ae.refresh(Object.keys(n.tags).join(" "))},error:function(e,n,t){(t=q(ve,e.errors,n,e.form,e.isArray))?(b(be,n,t),q(be,t,n,e.form),e.remove()):(b(ve,n,e.errors),(t=q(_e,[!0],n,e.form))?(b(be,n,t),q(be,t,n,e.form),e.remove()):b(_e,n)),n.isForm&&u(n.parent,n,he)},load:function(e,n){D(n._id)},ready:function(e,n,t){(t=n._refresh)&&t.r&&U(n,t)},data:function(e,n){n._data=e.loaded},remove:function(e,n,t,r,i){D(n._id),t=n._n,r=r?1:0;for(i in t)for(var o=t[i];o.length>r;)n._d.push(o.pop());r||(n._n={})}}),$H.on(a,function(){var e,n,t,r,i,o,f,s={},l=0,u=0,h={},p={},m=function(e,n,t,r){if(n=e._g)for(t=n.length;t--;)if((r=n[t])._a){for(r=r._s,t=n.length;t--;)(e=n[t])._a||e["final"]===!1||C(e,1),e._s=r;break}},g=function(e,n,r){if(e._a){if(s[n=e._id]=e,l++,i||n in Z||(i=!0),d(r=e["break"])&&(r=r.call(e)),(n=e._refresh)&&(n=n.p))for(t in n)p[t]=!0;return!!r}};for(n=0;n<re.length;n++)if(r=re[n],r._a){e=r;for(t in V)r=V[t],r.root!==e||r._a||C(r,1);c(e,a,m),c(e,a,g);break}for(n in Z)if(u++,r=Z[n],r.isNamed&&r.parent._id in s&&(s[n]=r),n=n in s)t=W[r._id],t&&(X||t.errors||!r._s&&!r.isNamed||r.keep===!1)&&t.remove(),r._s=1;else{b("leave",r),r._data=a;var v=r._p,_=Object.keys(v);for(n=_.length;n--;)delete v[_[n]]}for(n in p)for(t in s)r=s[t],(o=r.tags)&&n in o&&(D(t),h[t]=r);Z=s,X=a,G=e,f=te,te=p,ne=h;for(n in f)if(!(n in p))for(t in s)r=s[t],(o=r.tags)&&n in o&&(o=r._refresh)&&o.r&&U(r,o);W.mount(e),!i&&u>l&&E()}),Ae.on("before after stop",function(e){ce+=e===me?1:-1,Y&&o(Y),Y=i(function(){e=fe,fe=!!ce,Y=a,e!==fe&&b(ce?"busy":"idle",Ae)},0)}),s("click",function(e,n){for(var t=e.target;t&&!(t instanceof HTMLAnchorElement);)t=t.parentNode;!t||(n=t.target)&&!(n="$CR.replace"===n)||t.host!==r.host||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||1!==e.which||(e.preventDefault(),Ae.set(t.href,a,n))},!1),s(ye,function(e){function n(e){c=d(c=m.getAttribute("action")||i.action)?c.call(m,e,t):c||r.href,s=i.type||"qs","get"===i.method&&"qs"===s&&(e.length&&(c+=(~c.indexOf("?")?"&":"?")+f(e)),e=a),"qs"!==s||e&&e.length||(e=s=a),i[ue]=[!1,[c]],W[t._id].submit(i,m,function(n,r){return(e!==a||s!==a)&&n.setRequestHeader("Content-Type","text"===s?"text/plain":"json"===s?"application/json":"application/x-www-form-urlencoded"),(r=i.xhr)&&r.call(m,n,e,t),u(t,i,pe),"json"===s?JSON.stringify(e):e?"text"===s?e+"":f(e||[]):a})}for(var t,i,o,c,s,l,h,p=e.target,m=p;p&&!(t=p[le]);)p=p.parentNode;t&&t.form&&((l=t.checkForm(m))!==a&&(e.preventDefault(),i=m[le+"f"]),l&&(Z[i._id]=i,o=i._se,i.method=(m.getAttribute("method")||i._method||"get").toLowerCase(),o=(l=i[ye])?l.call(m,o,t,function(){h=!0}):o,h||(o&&d(o.then)?o.then(n):n(o)))),i||"get"!==m.method||m.target||(o=A(m.action),o.host===r.host&&(e.preventDefault(),c=o.pathname+o.search,Ae.set(("/"===c[0]?c:"/"+c)+(o.search?"&":"?")+f(I(m)))))}),J=!0,$H.run(),Ae._debug={f:re}},Ae.serializeForm=I,Ae.makeURI=function(e,n){return O(a,e,n)},Ae.on=function(e,n,t){var r,i,o="";if(m(e)&&d(n))if(e=e.split(se),1===e.length)(r=ae[e])&&(t&&((o=oe[t])&&(t=o),o=t._id),(i=r[o])||(i=r[o]=[]),i.push(n));else for(o=e.length;o--;)Ae.on(e[o],n,t);return Ae},Ae.off=function(e,n,t){var r,i="";if(m(e)&&d(n))if(e=e.split(se),1===e.length){if(t&&((i=oe[t])&&(t=i),i=t._id),(r=ae[e])&&(r=r[i]))for(i=r.length;i--;)r[i]===n&&r.splice(i,1)}else for(i=e.length;i--;)Ae.on(e[i],n,t);return Ae},Ae.get=function(e,n){var t=oe[e];return n?t&&t.get(n):t},Ae.params=function(){return B},Ae.$={uri:function(e,n,t,r){var i=new je(1);return i.u=e,i.p=n,i.r=t,i.e=r,i},"static":function(e){var n=new je(2);return n.v=e,n},tpl:function(e,n,t){var r=new je(3);return r.n=e,r.p=n,r.r=t,r},data:function(e){var n=new je(4);return e&&e.uri||_("No URI"),n.v=e,n},refresh:function(e){var n,t,r,i=new je(5);if((d(e)||"number"==typeof e)&&(e={refresh:e}),e&&(i.r=e.refresh,i.o=e.timeout,i.a=e.retry,n=e.pause))for(n=n.split(se),i.p=r={},t=n.length;t--;)r[n[t]]=!0;return i.r||i.o||i.p||_("Wrong refresh"),i}},Ae.refresh=function(e){e=e.split(se),c(G,a,function(n,t,r,i){if(n._id in Z&&!n.isForm&&(r=n.tags))for(t=n._refresh||{},i=e.length;i--;)if(e[i]in r){U(n,{o:t.o},0);break}})},xe.reload=function(){var e=this,n=W[e._id];n&&(n.remove(),W.mount(G))},xe.refresh=function(e){U(this,{},0,e===a?a:j(e))},xe.params=function(){return this._p||a},xe.data=function(e){var n=this._data;return p(n)?-1===e?n:n[e||0]:a},xe.makeURI=function(e){return O(this,this.uri,e||{})},xe.active=function(e){return this._id in Z&&(e?1===this._s:!0)},xe.checkForm=function(e){for(var n,t,r,i,o,f,c,s,u,h,d=e,m=this;d&&!(r=d[le]);)d=d.parentNode;if(m===r&&(d=m.form)){if(!(i=e[r=le+"f"]))for(p(d)||(d=[d]),n=0;n<d.length;n++)if(t=d[n],!t.match||e[Ce](t.match)){i=e[r]=new x(a,a,a,t,a,a,m,!0);break}if(i){for(o=I(e,!0),f=i._fi=o[1],i._se=o=o[0],c=i.check,d=0;d<f.length;d++)s=f[d],u=c?c.call(m,s[0],s[1],o):a,l(m,i,s,u?(h=!0,de):he,u);return!h}}},xe.get=function(e){return this.namedChildren[e]},xe.activate=function(e){s(!0,this,e)},xe.deactivate=function(){s(!1,this)},$H.on({search:function(e,t,r,i,o,f){for(V={},f=function(e){e._a=0},t=re.length;t--;)c(re[t],a,f);for(B={},e=e.split("&"),t=0;t<e.length;t++)(i=e[t])&&(~(o=i.indexOf("="))?(o=i.substring(o+1),i=n(i.substring(0,i.length-o.length-1)),o=n(o)):o=ke,(f=B[i])?(p(f)||(f=[f]),f.push(o)):f=o,B[i]=f)}},{}),xe=H.prototype,xe.then=function(e,n){var t=this;e&&t.ok.push(e),n&&t.err.push(n),t.done()},xe.reject=function(){var e=this;e.d||(e.r&&(e.r.abort(),e.r=a),e.d=e.e=!0,e.done())},xe.done=function(){var e,n,t=this;if(t.d)for(t.e?(e=t.err,n=t.r):(e=t.ok,n=t.j);e.length;)e.shift()(n)},xe=T.prototype,xe.mount=function(e,n){var t=this,r=t.loading;r&&t.frame===e?r.reconcile():(t.frame=e,r&&r.remove(),t.loading=r=e?new M(e,a,t):a),r&&r.load(n)},xe.unmount=function(){this.loading&&this.loading.remove()},xe=M.prototype,xe.emit=function(e){var n=this.root.handlers[e];n&&n(this,this.frame)},xe.reconcile=function(){var e,n,t,r,i,o=this,a=o.frame;if(a._id in Z){for(e=o.children,n=Object.keys(e),t=0;t<n.length;t++)e[n[t]].reconcile();for(r=a.children,t=0;t<r.length;t++)a=r[t],i=a._id,i in Z&&!(i in e)&&new M(a,o,o.root)}else a.isForm&&o.parent.frame._id in Z||o.remove()},xe.load=function(e){function n(e){i.then(function(n){o[e]=n,t()},function(n){f||(c.errors=f=new Array(o.length)),f[e]=n,t()})}function t(){if(u--,!u&&!c.aborted){for(c.loading=a,c.counters(-1),f?c.remove(!0):(c.loaded=o,c.emit("data")),r=c.root,i=[],S(r.loading,function(e){e.done||e.loading||!e.loaded&&!e.errors||e.parent&&!e.parent.done||e.waiting&&(e.frame.wait||r.wait)||(e.done=!0,e.emit(e.errors?ve:ge)),e.done&&!e.count&&i.push(e)});r=i.shift();)r.emit("ready");f||c.loadChildren()}}var r,i,o,f,c=this,s=c.frame,l=e||s[ue],u=1;if(c.loaded&&c.loadChildren(),!c.loading&&!c.loaded){for(r=c;r;r=r.parent)r.emit("load");for(c.emit(me),o=c.loading=[],c.errors=a,c.isArray=l[0],l=l[1],r=0;r<l.length;r++)(i=l[r])&&($e(2,i)?i=i.v:d(i)?i=i.call(s,s._p):(i=new H(i,s,c.body),"o"in i&&(i=i.o)),u++,o.push(i),i&&d(i.then)?n(r):t());t()}},xe.submit=function(e,n,t){var r=this,i=new M(e,r,r.root,!0);i.form=n,i.body=t,i.load()},xe.loadChildren=function(){if(this.loaded){var e,n=this.children;for(e in n)n[e].load()}},xe.remove=function(e,n,t,r,i){for(n=this,i=n.root,t=Object.keys(n.children),r=t.length;r--;)n.children[t[r]].remove();e||(n.abort(),n.parent?delete n.parent.children[n.frame._id]:i.loading=a,delete i[n.frame._id],n.emit("remove"))},xe.abort=function(){var e,n,t=this,r=t.loading;if(t.aborted=!0,r){for(e=r.length;e--;)n=r[e],d(n.abort)&&n.abort(),d(n.reject)&&n.reject();t.counters(-1)}t.done||t.emit("stop"),t.loading=t.loaded=t.errors=a},xe.counters=function(e,n,t,r){for(n=this.root.wait,t=this;t;t=t.parent)t.count+=e,t.frame.wait||n||(r=!0),r||(t.waiting+=e)},Ae}(document,decodeURIComponent,encodeURIComponent,location,setTimeout,clearTimeout);